handle a variety of dataset